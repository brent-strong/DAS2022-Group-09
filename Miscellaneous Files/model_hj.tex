% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\title{G9\_p2}
\author{Hongjin Ren}
\date{2022/3/10}

\usepackage{amsmath,amssymb}
\usepackage{lmodern}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={G9\_p2},
  pdfauthor={Hongjin Ren},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering
\usepackage{booktabs}
\usepackage{longtable}
\usepackage{array}
\usepackage{multirow}
\usepackage{wrapfig}
\usepackage{float}
\usepackage{colortbl}
\usepackage{pdflscape}
\usepackage{tabu}
\usepackage{threeparttable}
\usepackage{threeparttablex}
\usepackage[normalem]{ulem}
\usepackage{makecell}
\usepackage{xcolor}
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi

\begin{document}
\maketitle

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(tidyverse)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## -- Attaching packages --------------------------------------- tidyverse 1.3.1 --
\end{verbatim}

\begin{verbatim}
## v ggplot2 3.3.5     v purrr   0.3.4
## v tibble  3.1.6     v dplyr   1.0.8
## v tidyr   1.2.0     v stringr 1.4.0
## v readr   2.1.2     v forcats 0.5.1
\end{verbatim}

\begin{verbatim}
## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(moderndive)}
\FunctionTok{library}\NormalTok{(skimr)}
\FunctionTok{library}\NormalTok{(kableExtra)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## 载入程辑包：'kableExtra'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:dplyr':
## 
##     group_rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(gridExtra)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## 载入程辑包：'gridExtra'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:dplyr':
## 
##     combine
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(broom)}
\FunctionTok{library}\NormalTok{(olsrr)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## 载入程辑包：'olsrr'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:datasets':
## 
##     rivers
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(gapminder)}
\FunctionTok{library}\NormalTok{(sjPlot)}
\FunctionTok{library}\NormalTok{(stats)}
\FunctionTok{library}\NormalTok{(jtools)}
\FunctionTok{library}\NormalTok{(MASS)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## 载入程辑包：'MASS'
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:olsrr':
## 
##     cement
\end{verbatim}

\begin{verbatim}
## The following object is masked from 'package:dplyr':
## 
##     select
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(janitor)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## 载入程辑包：'janitor'
\end{verbatim}

\begin{verbatim}
## The following objects are masked from 'package:stats':
## 
##     chisq.test, fisher.test
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(ROCR)}
\FunctionTok{library}\NormalTok{(ggplot2)}
\FunctionTok{library}\NormalTok{(GGally)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Registered S3 method overwritten by 'GGally':
##   method from   
##   +.gg   ggplot2
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{coffee }\OtherTok{\textless{}{-}} \FunctionTok{read\_csv}\NormalTok{(}\StringTok{"https://raw.githubusercontent.com/brent{-}strong/DAS2022{-}Group{-}09/main/dataset9.csv"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Rows: 1145 Columns: 8
## -- Column specification --------------------------------------------------------
## Delimiter: ","
## chr (2): country_of_origin, Qualityclass
## dbl (6): aroma, flavor, acidity, category_two_defects, altitude_mean_meters,...
## 
## i Use `spec()` to retrieve the full column specification for this data.
## i Specify the column types or set `show_col_types = FALSE` to quiet this message.
\end{verbatim}

\begin{itemize}
\tightlist
\item
  country\_of\_origin -- Country where the coffee bean originates from.
\item
  aroma -- Aroma grade (ranging from 0-10)
\item
  flavor -- Flavor grade (ranging from 0-10)
\item
  acidity -- Acidity grade (ranging from 0-10)
\item
  category\_two\_defects -- Count of category 2 type defects in the
  batch of coffee beans tested.
\item
  altitiude\_mean\_meters -- Mean altitude of the growers farm (in
  metres)
\item
  harvested -- Year the batch was harvested
\item
  Qualityclass -- Quality score for the batch (Good - ≥ 82.5, Poor -
  \textless82.5). Note: 82.5 was selected as the cut off as this is the
  median score for all the batches tested.
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{coffee }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{group\_by}\NormalTok{(country\_of\_origin) }\SpecialCharTok{\%\textgreater{}\%}
  \FunctionTok{summarise}\NormalTok{(}\AttributeTok{n=}\FunctionTok{n}\NormalTok{(),}\AttributeTok{Mean=}\FunctionTok{round}\NormalTok{(}\FunctionTok{mean}\NormalTok{(altitude\_mean\_meters,}\AttributeTok{na.rm=}\NormalTok{T),}\AttributeTok{digits=}\DecValTok{2}\NormalTok{), }\AttributeTok{St.Dev=}\FunctionTok{round}\NormalTok{(}\FunctionTok{sd}\NormalTok{(altitude\_mean\_meters,}\AttributeTok{na.rm=}\NormalTok{T),}\AttributeTok{digits=}\DecValTok{2}\NormalTok{),}
            \AttributeTok{Min=}\FunctionTok{min}\NormalTok{(altitude\_mean\_meters,}\AttributeTok{na.rm=}\NormalTok{T), }\AttributeTok{Q1 =} \FunctionTok{quantile}\NormalTok{(altitude\_mean\_meters,}\FloatTok{0.25}\NormalTok{,}\AttributeTok{na.rm=}\NormalTok{T), }\AttributeTok{Median=}\FunctionTok{median}\NormalTok{(altitude\_mean\_meters,}\AttributeTok{na.rm=}\NormalTok{T),}
            \AttributeTok{Q3 =} \FunctionTok{quantile}\NormalTok{(altitude\_mean\_meters,}\FloatTok{0.75}\NormalTok{,}\AttributeTok{na.rm=}\NormalTok{T), }\AttributeTok{Max=}\FunctionTok{max}\NormalTok{(altitude\_mean\_meters,}\AttributeTok{na.rm=}\NormalTok{T))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## # A tibble: 34 x 9
##    country_of_origin     n  Mean St.Dev   Min    Q1 Median    Q3    Max
##    <chr>             <int> <dbl>  <dbl> <dbl> <dbl>  <dbl> <dbl>  <dbl>
##  1 Brazil              116 1029.  1111.    1   890   1000  1200   11000
##  2 Burundi               2 1790    127. 1700  1745   1790  1835    1880
##  3 China                14 1472.   239. 1100  1250   1540  1638.   1850
##  4 Colombia            158 1608.   479.  175  1550   1750  1775    3850
##  5 Costa Rica           41 1335.   460.   13  1200   1300  1700    1900
##  6 Cote d?Ivoire         1  200     NA   200   200    200   200     200
##  7 Ecuador               3  420    537.   40   230    420   610     800
##  8 El Salvador          20 1338.   111. 1200  1250   1350  1438.   1500
##  9 Ethiopia             38 1783.   150. 1494. 1666.  1788. 1900    2075
## 10 Guatemala           152 4323. 23232.  158. 1311.  1372. 1537  190164
## # ... with 24 more rows
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{co\_Na }\OtherTok{\textless{}{-}} \FunctionTok{na.omit}\NormalTok{(coffee)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cor}\NormalTok{(co\_Na[}\DecValTok{2}\SpecialCharTok{:}\DecValTok{6}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                            aroma      flavor       acidity category_two_defects
## aroma                 1.00000000  0.82937156  0.7491356503          -0.14594972
## flavor                0.82937156  1.00000000  0.8396367164          -0.19038223
## acidity               0.74913565  0.83963672  1.0000000000          -0.13672750
## category_two_defects -0.14594972 -0.19038223 -0.1367274972           1.00000000
## altitude_mean_meters -0.01735196 -0.01247196  0.0007979318          -0.01963494
##                      altitude_mean_meters
## aroma                       -0.0173519613
## flavor                      -0.0124719569
## acidity                      0.0007979318
## category_two_defects        -0.0196349385
## altitude_mean_meters         1.0000000000
\end{verbatim}

\#factor the respond data

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{co\_Na}\SpecialCharTok{$}\NormalTok{class[co\_Na}\SpecialCharTok{$}\NormalTok{Qualityclass }\SpecialCharTok{==} \StringTok{"Poor"}\NormalTok{] }\OtherTok{\textless{}{-}} \DecValTok{0}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Unknown or uninitialised column: `class`.
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{co\_Na}\SpecialCharTok{$}\NormalTok{class[co\_Na}\SpecialCharTok{$}\NormalTok{Qualityclass }\SpecialCharTok{==} \StringTok{"Good"}\NormalTok{] }\OtherTok{\textless{}{-}} \DecValTok{1}
\NormalTok{co\_Na}\SpecialCharTok{$}\NormalTok{class }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(co\_Na}\SpecialCharTok{$}\NormalTok{class,}
                      \AttributeTok{levels =} \FunctionTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{),}
                      \AttributeTok{labels =} \FunctionTok{c}\NormalTok{(}\StringTok{"Poor"}\NormalTok{,}\StringTok{"Good"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\#\#divide 3 levels for the
\href{mailto:altitude@hameed}{\nolinkurl{altitude@hameed}}\_coffee\_2020

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{co\_Na}\SpecialCharTok{$}\NormalTok{level[co\_Na}\SpecialCharTok{$}\NormalTok{altitude\_mean\_meters}\SpecialCharTok{\textless{}}\DecValTok{900}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Unknown or uninitialised column: `level`.
\end{verbatim}

\begin{verbatim}
## NULL
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{co\_Na}\SpecialCharTok{$}\NormalTok{level[co\_Na}\SpecialCharTok{$}\NormalTok{altitude\_mean\_meters}\SpecialCharTok{\textgreater{}}\DecValTok{900} \SpecialCharTok{\&}\NormalTok{ co\_Na}\SpecialCharTok{$}\NormalTok{altitude\_mean\_meters}\SpecialCharTok{\textless{}}\DecValTok{1200}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Unknown or uninitialised column: `level`.
\end{verbatim}

\begin{verbatim}
## NULL
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{co\_Na}\SpecialCharTok{$}\NormalTok{level[co\_Na}\SpecialCharTok{$}\NormalTok{altitude\_mean\_meters}\SpecialCharTok{\textless{}}\DecValTok{900}\NormalTok{]}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Unknown or uninitialised column: `level`.
\end{verbatim}

\begin{verbatim}
## NULL
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggpairs}\NormalTok{(co\_Na, }\AttributeTok{columns=}\DecValTok{2}\SpecialCharTok{:}\DecValTok{6}\NormalTok{,}\FunctionTok{aes}\NormalTok{(}\AttributeTok{color=}\NormalTok{class))}
\end{Highlighting}
\end{Shaded}

\includegraphics{model_hj_files/figure-latex/unnamed-chunk-7-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{cor}\NormalTok{(coffee[}\DecValTok{2}\SpecialCharTok{:}\DecValTok{6}\NormalTok{])}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##                           aroma     flavor    acidity category_two_defects
## aroma                 1.0000000  0.8163686  0.7305343           -0.1544159
## flavor                0.8163686  1.0000000  0.8173142           -0.1961509
## acidity               0.7305343  0.8173142  1.0000000           -0.1371781
## category_two_defects -0.1544159 -0.1961509 -0.1371781            1.0000000
## altitude_mean_meters         NA         NA         NA                   NA
##                      altitude_mean_meters
## aroma                                  NA
## flavor                                 NA
## acidity                                NA
## category_two_defects                   NA
## altitude_mean_meters                    1
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{coffee }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{tabyl}\NormalTok{(Qualityclass, country\_of\_origin) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{adorn\_percentages}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{adorn\_pct\_formatting}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{adorn\_ns}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  Qualityclass     Brazil  Burundi    China    Colombia Costa Rica Cote d?Ivoire
##          Good  9.4% (55) 0.2% (1) 1.5% (9) 21.4% (126)  3.9% (23)      0.0% (0)
##          Poor 11.0% (61) 0.2% (1) 0.9% (5)  5.7%  (32)  3.2% (18)      0.2% (1)
##   Ecuador El Salvador  Ethiopia  Guatemala    Haiti  Honduras    India
##  0.2% (1)   2.4% (14) 6.0% (35) 12.9% (76) 0.2% (1) 2.0% (12) 0.9% (5)
##  0.4% (2)   1.1%  (6) 0.5%  (3) 13.6% (76) 0.7% (4) 6.5% (36) 0.9% (5)
##  Indonesia    Japan     Kenya     Laos    Malawi Mauritius      Mexico  Myanmar
##   1.5% (9) 0.2% (1) 3.7% (22) 0.0% (0) 0.2%  (1)  0.0% (0)  9.2%  (54) 0.0% (0)
##   1.3% (7) 0.0% (0) 0.4%  (2) 0.4% (2) 1.8% (10)  0.2% (1) 26.8% (149) 1.1% (6)
##  Nicaragua   Panama     Peru Philippines    Taiwan Tanzania, United Republic Of
##  0.9%  (5) 0.5% (3) 0.9% (5)    0.3% (2) 4.4% (26)                    2.7% (16)
##  3.2% (18) 0.2% (1) 0.7% (4)    0.5% (3) 6.5% (36)                    2.9% (16)
##   Thailand    Uganda United States United States (Hawaii)
##  2.7% (16) 4.3% (25)      1.0% (6)              5.8% (34)
##  1.3%  (7) 1.3%  (7)      0.5% (3)              5.0% (28)
##  United States (Puerto Rico)  Vietnam   Zambia
##                     0.2% (1) 0.7% (4) 0.0% (0)
##                     0.4% (2) 0.7% (4) 0.2% (1)
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{coffee }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{tabyl}\NormalTok{(Qualityclass, harvested) }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{adorn\_percentages}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{adorn\_pct\_formatting}\NormalTok{() }\SpecialCharTok{\%\textgreater{}\%} 
  \FunctionTok{adorn\_ns}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
##  Qualityclass      2010      2011        2012       2013        2014       2015
##          Good 4.1% (24) 4.1% (24) 21.6% (127) 13.9% (82) 18.4% (108) 12.1% (71)
##          Poor 1.4%  (8) 1.6%  (9) 32.3% (180) 14.2% (79) 19.4% (108) 10.1% (56)
##        2016      2017      2018       NA_
##  12.6% (74) 4.9% (29) 2.2% (13) 6.1% (36)
##  10.4% (58) 5.4% (30) 0.9%  (5) 4.3% (24)
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{ggplot}\NormalTok{(coffee, }\FunctionTok{aes}\NormalTok{(}\AttributeTok{x=}\NormalTok{ harvested,  }\AttributeTok{y =}\NormalTok{ ..prop.., }\AttributeTok{group=}\NormalTok{Qualityclass, }\AttributeTok{fill=}\NormalTok{Qualityclass)) }\SpecialCharTok{+} 
    \FunctionTok{geom\_bar}\NormalTok{(}\AttributeTok{position=}\StringTok{"dodge"}\NormalTok{, }\AttributeTok{stat=}\StringTok{"count"}\NormalTok{) }\SpecialCharTok{+}
    \FunctionTok{labs}\NormalTok{(}\AttributeTok{y =} \StringTok{"Proportion"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: Removed 60 rows containing non-finite values (stat_count).
\end{verbatim}

\includegraphics{model_hj_files/figure-latex/unnamed-chunk-10-1.pdf}

I think we need to transform the num:year to chr:year

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{co\_Na}\SpecialCharTok{$}\NormalTok{harvested }\OtherTok{\textless{}{-}} \FunctionTok{as.character}\NormalTok{(co\_Na}\SpecialCharTok{$}\NormalTok{harvested)}
\end{Highlighting}
\end{Shaded}

\#-------------------------------build model

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model\_glm }\OtherTok{\textless{}{-}} \FunctionTok{glm}\NormalTok{(class }\SpecialCharTok{\textasciitilde{}}\NormalTok{ aroma }\SpecialCharTok{+}\NormalTok{ flavor }\SpecialCharTok{+}\NormalTok{ acidity, }\AttributeTok{data =}\NormalTok{ co\_Na,}\AttributeTok{family =} \FunctionTok{binomial}\NormalTok{(}\AttributeTok{link =} \StringTok{"logit"}\NormalTok{))}
\FunctionTok{summary}\NormalTok{(model\_glm)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = class ~ aroma + flavor + acidity, family = binomial(link = "logit"), 
##     data = co_Na)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -4.1471  -0.3598   0.0012   0.4361   3.3188  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(>|z|)    
## (Intercept) -120.3387     8.4934 -14.169  < 2e-16 ***
## aroma          4.5044     0.6660   6.763 1.35e-11 ***
## flavor         7.0157     0.8325   8.428  < 2e-16 ***
## acidity        4.4230     0.6654   6.647 3.00e-11 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1296.13  on 934  degrees of freedom
## Residual deviance:  560.61  on 931  degrees of freedom
## AIC: 568.61
## 
## Number of Fisher Scoring iterations: 7
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model\_test }\OtherTok{\textless{}{-}} \FunctionTok{glm}\NormalTok{(class }\SpecialCharTok{\textasciitilde{}}\NormalTok{ aroma }\SpecialCharTok{+}\NormalTok{ flavor }\SpecialCharTok{+}\NormalTok{ acidity }\SpecialCharTok{+}\NormalTok{ country\_of\_origin }\SpecialCharTok{+}\NormalTok{ category\_two\_defects }\SpecialCharTok{+}\NormalTok{ altitude\_mean\_meters }\SpecialCharTok{+}\NormalTok{ harvested, }\AttributeTok{data =}\NormalTok{ co\_Na,}\AttributeTok{family =} \FunctionTok{binomial}\NormalTok{(}\AttributeTok{link =} \StringTok{"logit"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(model\_test)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = class ~ aroma + flavor + acidity + country_of_origin + 
##     category_two_defects + altitude_mean_meters + harvested, 
##     family = binomial(link = "logit"), data = co_Na)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -4.4725  -0.2531   0.0000   0.2883   3.4781  
## 
## Coefficients:
##                                                 Estimate Std. Error z value
## (Intercept)                                   -1.425e+02  1.139e+01 -12.507
## aroma                                          4.974e+00  8.274e-01   6.012
## flavor                                         8.356e+00  1.043e+00   8.008
## acidity                                        5.466e+00  8.172e-01   6.688
## country_of_originBurundi                       2.370e+00  4.766e+00   0.497
## country_of_originChina                         5.952e-01  1.073e+00   0.555
## country_of_originColombia                      2.132e+00  5.266e-01   4.048
## country_of_originCosta Rica                    4.251e-01  7.520e-01   0.565
## country_of_originCote d?Ivoire                -1.246e+01  6.523e+03  -0.002
## country_of_originEcuador                      -1.772e+00  1.484e+00  -1.194
## country_of_originEl Salvador                   6.952e-01  9.477e-01   0.734
## country_of_originEthiopia                      1.382e+01  9.392e+02   0.015
## country_of_originGuatemala                    -3.962e-01  5.082e-01  -0.780
## country_of_originHaiti                         2.090e+00  1.716e+00   1.218
## country_of_originHonduras                     -2.577e-01  6.556e-01  -0.393
## country_of_originIndia                        -2.836e+00  1.017e+00  -2.788
## country_of_originIndonesia                    -4.875e-02  9.704e-01  -0.050
## country_of_originKenya                         8.280e-01  1.578e+00   0.525
## country_of_originLaos                         -1.506e+01  4.474e+03  -0.003
## country_of_originMalawi                       -5.459e-01  1.263e+00  -0.432
## country_of_originMauritius                    -1.241e+01  6.523e+03  -0.002
## country_of_originMexico                       -6.235e-01  4.864e-01  -1.282
## country_of_originMyanmar                      -1.556e+01  2.375e+03  -0.007
## country_of_originNicaragua                     4.353e-01  1.949e+00   0.223
## country_of_originPanama                        3.442e+00  1.889e+00   1.822
## country_of_originPeru                         -1.396e+01  6.523e+03  -0.002
## country_of_originPhilippines                   2.959e+00  2.746e+00   1.078
## country_of_originTaiwan                        6.392e-01  6.552e-01   0.976
## country_of_originTanzania, United Republic Of  1.278e+00  7.237e-01   1.766
## country_of_originThailand                      2.534e+00  9.648e-01   2.627
## country_of_originUganda                       -1.234e+00  7.516e-01  -1.642
## country_of_originUnited States                 2.744e-01  1.461e+00   0.188
## country_of_originUnited States (Hawaii)        4.037e+00  6.523e+03   0.001
## country_of_originUnited States (Puerto Rico)  -3.365e+00  1.706e+00  -1.972
## country_of_originVietnam                       2.228e+00  1.157e+00   1.926
## country_of_originZambia                       -1.358e+01  6.523e+03  -0.002
## category_two_defects                           6.304e-02  3.359e-02   1.877
## altitude_mean_meters                          -7.424e-06  2.077e-05  -0.358
## harvested2011                                 -2.281e-01  1.114e+00  -0.205
## harvested2012                                 -6.551e-02  9.626e-01  -0.068
## harvested2013                                  4.974e-01  9.709e-01   0.512
## harvested2014                                 -6.393e-02  9.803e-01  -0.065
## harvested2015                                 -6.991e-02  9.726e-01  -0.072
## harvested2016                                  4.941e-01  1.014e+00   0.487
## harvested2017                                  4.515e-01  1.019e+00   0.443
## harvested2018                                  1.749e+00  1.259e+00   1.389
##                                               Pr(>|z|)    
## (Intercept)                                    < 2e-16 ***
## aroma                                         1.83e-09 ***
## flavor                                        1.16e-15 ***
## acidity                                       2.26e-11 ***
## country_of_originBurundi                       0.61893    
## country_of_originChina                         0.57903    
## country_of_originColombia                     5.16e-05 ***
## country_of_originCosta Rica                    0.57192    
## country_of_originCote d?Ivoire                 0.99848    
## country_of_originEcuador                       0.23249    
## country_of_originEl Salvador                   0.46323    
## country_of_originEthiopia                      0.98826    
## country_of_originGuatemala                     0.43562    
## country_of_originHaiti                         0.22312    
## country_of_originHonduras                      0.69430    
## country_of_originIndia                         0.00531 ** 
## country_of_originIndonesia                     0.95993    
## country_of_originKenya                         0.59968    
## country_of_originLaos                          0.99731    
## country_of_originMalawi                        0.66564    
## country_of_originMauritius                     0.99848    
## country_of_originMexico                        0.19989    
## country_of_originMyanmar                       0.99477    
## country_of_originNicaragua                     0.82330    
## country_of_originPanama                        0.06845 .  
## country_of_originPeru                          0.99829    
## country_of_originPhilippines                   0.28119    
## country_of_originTaiwan                        0.32926    
## country_of_originTanzania, United Republic Of  0.07745 .  
## country_of_originThailand                      0.00862 ** 
## country_of_originUganda                        0.10067    
## country_of_originUnited States                 0.85104    
## country_of_originUnited States (Hawaii)        0.99951    
## country_of_originUnited States (Puerto Rico)   0.04858 *  
## country_of_originVietnam                       0.05412 .  
## country_of_originZambia                        0.99834    
## category_two_defects                           0.06056 .  
## altitude_mean_meters                           0.72071    
## harvested2011                                  0.83774    
## harvested2012                                  0.94574    
## harvested2013                                  0.60848    
## harvested2014                                  0.94800    
## harvested2015                                  0.94270    
## harvested2016                                  0.62598    
## harvested2017                                  0.65754    
## harvested2018                                  0.16472    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1296.13  on 934  degrees of freedom
## Residual deviance:  458.01  on 889  degrees of freedom
## AIC: 550.01
## 
## Number of Fisher Scoring iterations: 17
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model\_test }\OtherTok{\textless{}{-}} \FunctionTok{glm}\NormalTok{(class }\SpecialCharTok{\textasciitilde{}}\NormalTok{ aroma }\SpecialCharTok{+}\NormalTok{ flavor }\SpecialCharTok{+}\NormalTok{ acidity }\SpecialCharTok{+}\NormalTok{ country\_of\_origin }\SpecialCharTok{+}\NormalTok{ category\_two\_defects }\SpecialCharTok{+}\NormalTok{ altitude\_mean\_meters, }\AttributeTok{data =}\NormalTok{ co\_Na,}\AttributeTok{family =} \FunctionTok{binomial}\NormalTok{(}\AttributeTok{link =} \StringTok{"logit"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{summary}\NormalTok{(model\_test)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = class ~ aroma + flavor + acidity + country_of_origin + 
##     category_two_defects + altitude_mean_meters, family = binomial(link = "logit"), 
##     data = co_Na)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -4.4126  -0.2513   0.0000   0.2910   3.5418  
## 
## Coefficients:
##                                                 Estimate Std. Error z value
## (Intercept)                                   -1.383e+02  1.082e+01 -12.785
## aroma                                          4.745e+00  7.946e-01   5.971
## flavor                                         7.965e+00  1.000e+00   7.964
## acidity                                        5.585e+00  7.994e-01   6.987
## country_of_originBurundi                       2.142e+00  5.038e+00   0.425
## country_of_originChina                         1.581e-01  1.001e+00   0.158
## country_of_originColombia                      1.897e+00  4.806e-01   3.948
## country_of_originCosta Rica                    2.362e-01  7.035e-01   0.336
## country_of_originCote d?Ivoire                -1.244e+01  6.523e+03  -0.002
## country_of_originEcuador                      -1.670e+00  1.463e+00  -1.141
## country_of_originEl Salvador                   6.218e-01  9.312e-01   0.668
## country_of_originEthiopia                      1.390e+01  9.353e+02   0.015
## country_of_originGuatemala                    -5.621e-01  4.537e-01  -1.239
## country_of_originHaiti                         1.849e+00  1.792e+00   1.032
## country_of_originHonduras                     -3.361e-01  6.050e-01  -0.555
## country_of_originIndia                        -3.035e+00  9.807e-01  -3.095
## country_of_originIndonesia                    -3.344e-01  8.843e-01  -0.378
## country_of_originKenya                         1.121e+00  1.446e+00   0.775
## country_of_originLaos                         -1.546e+01  4.400e+03  -0.004
## country_of_originMalawi                       -1.021e+00  1.198e+00  -0.852
## country_of_originMauritius                    -1.247e+01  6.523e+03  -0.002
## country_of_originMexico                       -9.513e-01  4.232e-01  -2.248
## country_of_originMyanmar                      -1.606e+01  2.386e+03  -0.007
## country_of_originNicaragua                     2.559e-01  1.934e+00   0.132
## country_of_originPanama                        2.887e+00  1.852e+00   1.559
## country_of_originPeru                         -1.449e+01  6.523e+03  -0.002
## country_of_originPhilippines                   2.443e+00  2.614e+00   0.935
## country_of_originTaiwan                        3.318e-01  6.029e-01   0.550
## country_of_originTanzania, United Republic Of  9.010e-01  6.770e-01   1.331
## country_of_originThailand                      2.053e+00  9.087e-01   2.260
## country_of_originUganda                       -1.266e+00  7.010e-01  -1.806
## country_of_originUnited States                -1.488e-01  1.430e+00  -0.104
## country_of_originUnited States (Hawaii)        4.078e+00  6.523e+03   0.001
## country_of_originUnited States (Puerto Rico)  -3.139e+00  1.640e+00  -1.914
## country_of_originVietnam                       1.986e+00  1.125e+00   1.765
## country_of_originZambia                       -1.417e+01  6.523e+03  -0.002
## category_two_defects                           5.805e-02  3.250e-02   1.786
## altitude_mean_meters                          -7.432e-06  2.239e-05  -0.332
##                                               Pr(>|z|)    
## (Intercept)                                    < 2e-16 ***
## aroma                                         2.35e-09 ***
## flavor                                        1.67e-15 ***
## acidity                                       2.81e-12 ***
## country_of_originBurundi                       0.67065    
## country_of_originChina                         0.87454    
## country_of_originColombia                     7.88e-05 ***
## country_of_originCosta Rica                    0.73712    
## country_of_originCote d?Ivoire                 0.99848    
## country_of_originEcuador                       0.25390    
## country_of_originEl Salvador                   0.50430    
## country_of_originEthiopia                      0.98814    
## country_of_originGuatemala                     0.21535    
## country_of_originHaiti                         0.30223    
## country_of_originHonduras                      0.57856    
## country_of_originIndia                         0.00197 ** 
## country_of_originIndonesia                     0.70527    
## country_of_originKenya                         0.43823    
## country_of_originLaos                          0.99720    
## country_of_originMalawi                        0.39414    
## country_of_originMauritius                     0.99848    
## country_of_originMexico                        0.02459 *  
## country_of_originMyanmar                       0.99463    
## country_of_originNicaragua                     0.89473    
## country_of_originPanama                        0.11909    
## country_of_originPeru                          0.99823    
## country_of_originPhilippines                   0.34998    
## country_of_originTaiwan                        0.58205    
## country_of_originTanzania, United Republic Of  0.18323    
## country_of_originThailand                      0.02385 *  
## country_of_originUganda                        0.07090 .  
## country_of_originUnited States                 0.91713    
## country_of_originUnited States (Hawaii)        0.99950    
## country_of_originUnited States (Puerto Rico)   0.05560 .  
## country_of_originVietnam                       0.07750 .  
## country_of_originZambia                        0.99827    
## category_two_defects                           0.07413 .  
## altitude_mean_meters                           0.73992    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1296.13  on 934  degrees of freedom
## Residual deviance:  466.14  on 897  degrees of freedom
## AIC: 542.14
## 
## Number of Fisher Scoring iterations: 17
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model\_year }\OtherTok{\textless{}{-}} \FunctionTok{glm}\NormalTok{(class }\SpecialCharTok{\textasciitilde{}}\NormalTok{ harvested, }\AttributeTok{data =}\NormalTok{ co\_Na,}\AttributeTok{family =} \FunctionTok{binomial}\NormalTok{(}\AttributeTok{link =} \StringTok{"logit"}\NormalTok{))}
\FunctionTok{summary}\NormalTok{(model\_year)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = class ~ harvested, family = binomial(link = "logit"), 
##     data = co_Na)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.7125  -1.1774   0.7244   1.1146   1.3683  
## 
## Coefficients:
##               Estimate Std. Error z value Pr(>|z|)    
## (Intercept)     1.2040     0.4655   2.587 0.009694 ** 
## harvested2011  -0.1924     0.6222  -0.309 0.757181    
## harvested2012  -1.6422     0.4828  -3.401 0.000671 ***
## harvested2013  -1.0544     0.4967  -2.123 0.033753 *  
## harvested2014  -1.2040     0.4871  -2.472 0.013450 *  
## harvested2015  -1.0369     0.5002  -2.073 0.038184 *  
## harvested2016  -1.0111     0.5055  -2.000 0.045467 *  
## harvested2017  -1.3524     0.5396  -2.506 0.012198 *  
## harvested2018  -0.2485     0.7026  -0.354 0.723600    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1296.1  on 934  degrees of freedom
## Residual deviance: 1263.0  on 926  degrees of freedom
## AIC: 1281
## 
## Number of Fisher Scoring iterations: 4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model\_country }\OtherTok{\textless{}{-}} \FunctionTok{glm}\NormalTok{(class }\SpecialCharTok{\textasciitilde{}}\NormalTok{ country\_of\_origin, }\AttributeTok{data =}\NormalTok{ co\_Na,}\AttributeTok{family =} \FunctionTok{binomial}\NormalTok{(}\AttributeTok{link =} \StringTok{"logit"}\NormalTok{))}
\FunctionTok{summary}\NormalTok{(model\_country)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = class ~ country_of_origin, family = binomial(link = "logit"), 
##     data = co_Na)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -2.14597  -1.01655   0.00036   1.08424   2.18993  
## 
## Coefficients:
##                                                 Estimate Std. Error z value
## (Intercept)                                      0.08701    0.20871   0.417
## country_of_originBurundi                        -0.08701    1.42953  -0.061
## country_of_originChina                           0.50078    0.59554   0.841
## country_of_originColombia                        1.47591    0.31391   4.702
## country_of_originCosta Rica                      0.13613    0.39505   0.345
## country_of_originCote d?Ivoire                 -16.65308 2399.54473  -0.007
## country_of_originEcuador                        -0.08701    1.42953  -0.061
## country_of_originEl Salvador                     0.86850    0.56611   1.534
## country_of_originEthiopia                       16.47906  500.33970   0.033
## country_of_originGuatemala                      -0.04049    0.27310  -0.148
## country_of_originHaiti                          -1.47331    1.13735  -1.295
## country_of_originHonduras                       -1.15745    0.39429  -2.936
## country_of_originIndia                          -0.08701    0.66600  -0.131
## country_of_originIndonesia                       0.20067    0.57899   0.347
## country_of_originKenya                           2.11021    0.77403   2.726
## country_of_originLaos                          -16.65308 1696.73436  -0.010
## country_of_originMalawi                         -2.38960    1.06937  -2.235
## country_of_originMauritius                     -16.65308 2399.54473  -0.007
## country_of_originMexico                         -1.13298    0.26372  -4.296
## country_of_originMyanmar                       -16.65308  979.61005  -0.017
## country_of_originNicaragua                      -1.38629    0.68396  -2.027
## country_of_originPanama                          1.01160    1.17341   0.862
## country_of_originPeru                          -16.65308 2399.54473  -0.007
## country_of_originPhilippines                    -0.49248    0.93643  -0.526
## country_of_originTaiwan                         -0.47788    0.34125  -1.400
## country_of_originTanzania, United Republic Of   -0.15600    0.42621  -0.366
## country_of_originThailand                        0.20067    0.57899   0.347
## country_of_originUganda                          1.10257    0.47947   2.300
## country_of_originUnited States                   0.60614    0.73727   0.822
## country_of_originUnited States (Hawaii)         16.47906 2399.54473   0.007
## country_of_originUnited States (Puerto Rico)    -0.78016    1.24240  -0.628
## country_of_originVietnam                         0.20067    0.79177   0.253
## country_of_originZambia                        -16.65308 2399.54473  -0.007
##                                               Pr(>|z|)    
## (Intercept)                                    0.67675    
## country_of_originBurundi                       0.95147    
## country_of_originChina                         0.40042    
## country_of_originColombia                     2.58e-06 ***
## country_of_originCosta Rica                    0.73040    
## country_of_originCote d?Ivoire                 0.99446    
## country_of_originEcuador                       0.95147    
## country_of_originEl Salvador                   0.12499    
## country_of_originEthiopia                      0.97373    
## country_of_originGuatemala                     0.88213    
## country_of_originHaiti                         0.19519    
## country_of_originHonduras                      0.00333 ** 
## country_of_originIndia                         0.89605    
## country_of_originIndonesia                     0.72890    
## country_of_originKenya                         0.00641 ** 
## country_of_originLaos                          0.99217    
## country_of_originMalawi                        0.02545 *  
## country_of_originMauritius                     0.99446    
## country_of_originMexico                       1.74e-05 ***
## country_of_originMyanmar                       0.98644    
## country_of_originNicaragua                     0.04268 *  
## country_of_originPanama                        0.38863    
## country_of_originPeru                          0.99446    
## country_of_originPhilippines                   0.59895    
## country_of_originTaiwan                        0.16140    
## country_of_originTanzania, United Republic Of  0.71435    
## country_of_originThailand                      0.72890    
## country_of_originUganda                        0.02147 *  
## country_of_originUnited States                 0.41100    
## country_of_originUnited States (Hawaii)        0.99452    
## country_of_originUnited States (Puerto Rico)   0.53004    
## country_of_originVietnam                       0.79992    
## country_of_originZambia                        0.99446    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1296.1  on 934  degrees of freedom
## Residual deviance: 1077.4  on 902  degrees of freedom
## AIC: 1143.4
## 
## Number of Fisher Scoring iterations: 15
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{model\_cn\_ye }\OtherTok{\textless{}{-}} \FunctionTok{glm}\NormalTok{(class }\SpecialCharTok{\textasciitilde{}}\NormalTok{ country\_of\_origin }\SpecialCharTok{+}\NormalTok{ harvested, }\AttributeTok{data =}\NormalTok{ co\_Na,}\AttributeTok{family =} \FunctionTok{binomial}\NormalTok{(}\AttributeTok{link =} \StringTok{"logit"}\NormalTok{))}
\FunctionTok{summary}\NormalTok{(model\_cn\_ye)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## 
## Call:
## glm(formula = class ~ country_of_origin + harvested, family = binomial(link = "logit"), 
##     data = co_Na)
## 
## Deviance Residuals: 
##      Min        1Q    Median        3Q       Max  
## -2.16586  -0.97714   0.00032   1.00332   2.18993  
## 
## Coefficients:
##                                                 Estimate Std. Error z value
## (Intercept)                                    3.047e-03  5.948e-01   0.005
## country_of_originBurundi                       1.376e-01  1.439e+00   0.096
## country_of_originChina                         7.241e-01  6.292e-01   1.151
## country_of_originColombia                      1.807e+00  3.395e-01   5.322
## country_of_originCosta Rica                    4.547e-01  4.201e-01   1.082
## country_of_originCote d?Ivoire                -1.658e+01  2.400e+03  -0.007
## country_of_originEcuador                       3.015e-01  1.456e+00   0.207
## country_of_originEl Salvador                   1.136e+00  5.840e-01   1.945
## country_of_originEthiopia                      1.679e+01  4.978e+02   0.034
## country_of_originGuatemala                     3.536e-01  3.041e-01   1.163
## country_of_originHaiti                        -9.782e-01  1.153e+00  -0.848
## country_of_originHonduras                     -9.299e-01  4.172e-01  -2.229
## country_of_originIndia                         2.446e-01  6.894e-01   0.355
## country_of_originIndonesia                     3.986e-01  5.999e-01   0.664
## country_of_originKenya                         2.550e+00  7.908e-01   3.225
## country_of_originLaos                         -1.661e+01  1.697e+03  -0.010
## country_of_originMalawi                       -1.951e+00  1.092e+00  -1.786
## country_of_originMauritius                    -1.658e+01  2.400e+03  -0.007
## country_of_originMexico                       -7.528e-01  3.130e-01  -2.405
## country_of_originMyanmar                      -1.657e+01  9.761e+02  -0.017
## country_of_originNicaragua                    -1.251e+00  7.005e-01  -1.785
## country_of_originPanama                        1.455e+00  1.187e+00   1.226
## country_of_originPeru                         -1.628e+01  2.400e+03  -0.007
## country_of_originPhilippines                  -1.539e-01  9.529e-01  -0.161
## country_of_originTaiwan                       -1.395e-01  3.716e-01  -0.375
## country_of_originTanzania, United Republic Of  1.832e-01  4.571e-01   0.401
## country_of_originThailand                      5.764e-01  6.008e-01   0.959
## country_of_originUganda                        1.641e+00  5.168e-01   3.175
## country_of_originUnited States                 1.037e+00  7.651e-01   1.356
## country_of_originUnited States (Hawaii)        1.656e+01  2.400e+03   0.007
## country_of_originUnited States (Puerto Rico)  -8.067e-02  1.268e+00  -0.064
## country_of_originVietnam                       6.438e-01  8.111e-01   0.794
## country_of_originZambia                       -1.621e+01  2.400e+03  -0.007
## harvested2011                                  4.349e-01  7.133e-01   0.610
## harvested2012                                 -2.878e-01  5.844e-01  -0.492
## harvested2013                                 -6.155e-01  5.921e-01  -1.039
## harvested2014                                 -3.548e-01  5.892e-01  -0.602
## harvested2015                                  6.766e-02  5.958e-01   0.114
## harvested2016                                  6.448e-03  5.975e-01   0.011
## harvested2017                                 -4.365e-01  6.366e-01  -0.686
## harvested2018                                  7.839e-01  7.966e-01   0.984
##                                               Pr(>|z|)    
## (Intercept)                                    0.99591    
## country_of_originBurundi                       0.92383    
## country_of_originChina                         0.24984    
## country_of_originColombia                     1.02e-07 ***
## country_of_originCosta Rica                    0.27913    
## country_of_originCote d?Ivoire                 0.99449    
## country_of_originEcuador                       0.83593    
## country_of_originEl Salvador                   0.05176 .  
## country_of_originEthiopia                      0.97309    
## country_of_originGuatemala                     0.24494    
## country_of_originHaiti                         0.39632    
## country_of_originHonduras                      0.02582 *  
## country_of_originIndia                         0.72270    
## country_of_originIndonesia                     0.50638    
## country_of_originKenya                         0.00126 ** 
## country_of_originLaos                          0.99219    
## country_of_originMalawi                        0.07411 .  
## country_of_originMauritius                     0.99449    
## country_of_originMexico                        0.01618 *  
## country_of_originMyanmar                       0.98646    
## country_of_originNicaragua                     0.07422 .  
## country_of_originPanama                        0.22027    
## country_of_originPeru                          0.99459    
## country_of_originPhilippines                   0.87173    
## country_of_originTaiwan                        0.70737    
## country_of_originTanzania, United Republic Of  0.68857    
## country_of_originThailand                      0.33737    
## country_of_originUganda                        0.00150 ** 
## country_of_originUnited States                 0.17507    
## country_of_originUnited States (Hawaii)        0.99449    
## country_of_originUnited States (Puerto Rico)   0.94928    
## country_of_originVietnam                       0.42732    
## country_of_originZambia                        0.99461    
## harvested2011                                  0.54203    
## harvested2012                                  0.62243    
## harvested2013                                  0.29857    
## harvested2014                                  0.54710    
## harvested2015                                  0.90959    
## harvested2016                                  0.99139    
## harvested2017                                  0.49290    
## harvested2018                                  0.32506    
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 1296.1  on 934  degrees of freedom
## Residual deviance: 1065.9  on 894  degrees of freedom
## AIC: 1147.9
## 
## Number of Fisher Scoring iterations: 15
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{stepAIC}\NormalTok{(model\_test, }\AttributeTok{direction =} \StringTok{\textquotesingle{}both\textquotesingle{}}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## Start:  AIC=542.14
## class ~ aroma + flavor + acidity + country_of_origin + category_two_defects + 
##     altitude_mean_meters
\end{verbatim}

\begin{verbatim}
## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
\end{verbatim}

\begin{verbatim}
##                        Df Deviance    AIC
## - altitude_mean_meters  1   466.31 540.31
## <none>                      466.14 542.14
## - category_two_defects  1   469.17 543.17
## - country_of_origin    32   559.98 571.98
## - aroma                 1   517.27 591.27
## - acidity               1   528.01 602.01
## - flavor                1   555.95 629.95
\end{verbatim}

\begin{verbatim}
## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
\end{verbatim}

\begin{verbatim}
## 
## Step:  AIC=540.31
## class ~ aroma + flavor + acidity + country_of_origin + category_two_defects
\end{verbatim}

\begin{verbatim}
## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred

## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred
\end{verbatim}

\begin{verbatim}
##                        Df Deviance    AIC
## <none>                      466.31 540.31
## - category_two_defects  1   469.37 541.37
## + altitude_mean_meters  1   466.14 542.14
## - country_of_origin    32   560.42 570.42
## - aroma                 1   517.72 589.72
## - acidity               1   528.15 600.15
## - flavor                1   556.58 628.58
\end{verbatim}

\begin{verbatim}
## 
## Call:  glm(formula = class ~ aroma + flavor + acidity + country_of_origin + 
##     category_two_defects, family = binomial(link = "logit"), 
##     data = co_Na)
## 
## Coefficients:
##                                   (Intercept)  
##                                     -138.5901  
##                                         aroma  
##                                        4.7601  
##                                        flavor  
##                                        7.9877  
##                                       acidity  
##                                        5.5857  
##                      country_of_originBurundi  
##                                        2.1421  
##                        country_of_originChina  
##                                        0.1546  
##                     country_of_originColombia  
##                                        1.8942  
##                   country_of_originCosta Rica  
##                                        0.2345  
##                country_of_originCote d?Ivoire  
##                                      -12.4232  
##                      country_of_originEcuador  
##                                       -1.6654  
##                  country_of_originEl Salvador  
##                                        0.6202  
##                     country_of_originEthiopia  
##                                       13.8876  
##                    country_of_originGuatemala  
##                                       -0.5802  
##                        country_of_originHaiti  
##                                        1.8537  
##                     country_of_originHonduras  
##                                       -0.3375  
##                        country_of_originIndia  
##                                       -3.0428  
##                    country_of_originIndonesia  
##                                       -0.3381  
##                        country_of_originKenya  
##                                        1.1188  
##                         country_of_originLaos  
##                                      -15.4594  
##                       country_of_originMalawi  
##                                       -1.0222  
##                    country_of_originMauritius  
##                                      -12.4469  
##                       country_of_originMexico  
##                                       -0.9539  
##                      country_of_originMyanmar  
##                                      -16.0614  
##                    country_of_originNicaragua  
##                                        0.2442  
##                       country_of_originPanama  
##                                        2.8919  
##                         country_of_originPeru  
##                                      -14.4872  
##                  country_of_originPhilippines  
##                                        2.4469  
##                       country_of_originTaiwan  
##                                        0.3353  
## country_of_originTanzania, United Republic Of  
##                                        0.9002  
##                     country_of_originThailand  
##                                        2.0581  
##                       country_of_originUganda  
##                                       -1.2744  
##                country_of_originUnited States  
##                                       -0.1566  
##       country_of_originUnited States (Hawaii)  
##                                        4.0495  
##  country_of_originUnited States (Puerto Rico)  
##                                       -3.1452  
##                      country_of_originVietnam  
##                                        1.9889  
##                       country_of_originZambia  
##                                      -14.1569  
##                          category_two_defects  
##                                        0.0583  
## 
## Degrees of Freedom: 934 Total (i.e. Null);  898 Residual
## Null Deviance:       1296 
## Residual Deviance: 466.3     AIC: 540.3
\end{verbatim}

\#--------------------------------test model

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pre }\OtherTok{\textless{}{-}} \FunctionTok{predict}\NormalTok{(model\_country,}\AttributeTok{type=}\StringTok{\textquotesingle{}response\textquotesingle{}}\NormalTok{)}

\NormalTok{data }\OtherTok{\textless{}{-}} \FunctionTok{data.frame}\NormalTok{(}\AttributeTok{prob=}\NormalTok{pre,}\AttributeTok{obs=}\NormalTok{co\_Na}\SpecialCharTok{$}\NormalTok{class)}

\NormalTok{data }\OtherTok{\textless{}{-}}\NormalTok{ data[}\FunctionTok{order}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{prob),]}
\NormalTok{n }\OtherTok{\textless{}{-}} \FunctionTok{nrow}\NormalTok{(data)}
\NormalTok{tpr }\OtherTok{\textless{}{-}}\NormalTok{ fpr }\OtherTok{\textless{}{-}} \FunctionTok{rep}\NormalTok{(}\DecValTok{0}\NormalTok{,n)}

\ControlFlowTok{for}\NormalTok{ (i }\ControlFlowTok{in} \DecValTok{1}\SpecialCharTok{:}\NormalTok{n) \{}
\NormalTok{    threshold }\OtherTok{\textless{}{-}}\NormalTok{ data}\SpecialCharTok{$}\NormalTok{prob[i]}
\NormalTok{    tp }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{prob }\SpecialCharTok{\textgreater{}}\NormalTok{ threshold }\SpecialCharTok{\&}\NormalTok{ data}\SpecialCharTok{$}\NormalTok{obs }\SpecialCharTok{==} \StringTok{"Good"}\NormalTok{)}
\NormalTok{    fp }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{prob }\SpecialCharTok{\textgreater{}}\NormalTok{ threshold }\SpecialCharTok{\&}\NormalTok{ data}\SpecialCharTok{$}\NormalTok{obs }\SpecialCharTok{==} \StringTok{"Poor"}\NormalTok{)}
\NormalTok{    tn }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{prob }\SpecialCharTok{\textless{}}\NormalTok{ threshold }\SpecialCharTok{\&}\NormalTok{ data}\SpecialCharTok{$}\NormalTok{obs }\SpecialCharTok{==} \StringTok{"Poor"}\NormalTok{)}
\NormalTok{    fn }\OtherTok{\textless{}{-}} \FunctionTok{sum}\NormalTok{(data}\SpecialCharTok{$}\NormalTok{prob }\SpecialCharTok{\textless{}}\NormalTok{ threshold }\SpecialCharTok{\&}\NormalTok{ data}\SpecialCharTok{$}\NormalTok{obs }\SpecialCharTok{==} \StringTok{"Good"}\NormalTok{)}
\NormalTok{    tpr[i] }\OtherTok{\textless{}{-}}\NormalTok{ tp}\SpecialCharTok{/}\NormalTok{(tp}\SpecialCharTok{+}\NormalTok{fn) }\CommentTok{\# 真正率}
\NormalTok{    fpr[i] }\OtherTok{\textless{}{-}}\NormalTok{ fp}\SpecialCharTok{/}\NormalTok{(tn}\SpecialCharTok{+}\NormalTok{fp) }\CommentTok{\# 假正率}
\NormalTok{\}}
\FunctionTok{plot}\NormalTok{(fpr,tpr,}\AttributeTok{type=}\StringTok{\textquotesingle{}l\textquotesingle{}}\NormalTok{)}
\FunctionTok{abline}\NormalTok{(}\AttributeTok{a=}\DecValTok{0}\NormalTok{,}\AttributeTok{b=}\DecValTok{1}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\includegraphics{model_hj_files/figure-latex/unnamed-chunk-19-1.pdf}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{pred }\OtherTok{\textless{}{-}} \FunctionTok{prediction}\NormalTok{(pre,co\_Na}\SpecialCharTok{$}\NormalTok{class)}
\FunctionTok{performance}\NormalTok{(pred,}\StringTok{\textquotesingle{}auc\textquotesingle{}}\NormalTok{)}\SpecialCharTok{@}\NormalTok{y.values }\CommentTok{\#AUC值}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
## [[1]]
## [1] 0.2462662
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{perf }\OtherTok{\textless{}{-}} \FunctionTok{performance}\NormalTok{(pred,}\StringTok{\textquotesingle{}fpr\textquotesingle{}}\NormalTok{,}\StringTok{\textquotesingle{}tpr\textquotesingle{}}\NormalTok{)}
\FunctionTok{plot}\NormalTok{(perf)}
\end{Highlighting}
\end{Shaded}

\includegraphics{model_hj_files/figure-latex/unnamed-chunk-20-1.pdf}

\#------------------

(\textbf{article?})\{hameed\_coffee\_2020, title = \{``\{\{Coffee\}\}
Bean-Related'' Agroecological Factors Affecting the Coffee\}, author =
\{Hameed, Ahsan and Hussain, Syed Ammar and Suleria, Hafiz Ansar
Rasul\}, date = \{2020\}, journaltitle = \{Co-Evolution of Secondary
Metabolites\}, pages = \{641--705\}, publisher = \{\{Springer\}\}, file
=
\{C:\textbackslash Users\textbackslash r4718\textbackslash Zotero\textbackslash storage\textbackslash LPXQJGMP\textbackslash Hameed
等。 - 2020 - ``Coffee bean-related'' agroecological factors
affec.pdf;C:\textbackslash Users\textbackslash r4718\textbackslash Zotero\textbackslash storage\textbackslash8AR4W9ET\textbackslash978-3-319-96397-6\_21.html\}
\}

\end{document}
