---
title: "G9_p2"
author: "Hongjin Ren"
date: "2022/3/10"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r libraries,warning=FALSE}
library(tidyverse)
library(moderndive)
library(skimr)
library(kableExtra)
library(gridExtra)
library(broom)
library(olsrr)
library(gapminder)
library(sjPlot)
library(stats)
library(jtools)
```

```{r,warning=FALSE}
coffee <- read_csv("https://raw.githubusercontent.com/brent-strong/DAS2022-Group-09/main/dataset9.csv")
```

- country_of_origin – Country where the coffee bean originates from.
- aroma – Aroma grade (ranging from 0-10)
- flavor – Flavor grade (ranging from 0-10)
- acidity – Acidity grade (ranging from 0-10)
- category_two_defects – Count of category 2 type defects in the batch of coffee beans tested.
- altitiude_mean_meters – Mean altitude of the growers farm (in metres)
- harvested – Year the batch was harvested
- Qualityclass – Quality score for the batch (Good - ≥ 82.5, Poor - <82.5). Note: 82.5
was selected as the cut off as this is the median score for all the batches tested.

```{r}
co_Na <- na.omit(coffee)
```

```{r}
cor(co_Na[2:6])
```


```{r}
library(ggplot2)
library(GGally)
ggpairs(co_Na, columns=2:6,aes(color=class))
cor(coffee[2:6])
```




#factor the respond data
```{r}
co_Na$class[co_Na$Qualityclass == "Poor"] <- 0
co_Na$class[co_Na$Qualityclass == "Good"] <- 1
co_Na$class <- factor(co_Na$class,
                      levels = c(0,1),
                      labels = c("Poor","Good"))

```


```{r,warning=FALSE}
ggplot(data = co_Na, mapping = aes(x = aroma, y = Qualityclass)) + 
  geom_point(alpha = 0.2) +
  labs(x = "   ", y = "  ",
       title = "The relationship of * and * in ") +
  geom_smooth(method = 'glm',method.args = list(family = 'binomial'),se = F)

```

```{r,warning=FALSE}
model_glm <- glm(class ~ aroma + flavor + acidity, data = co_Na,family = binomial(link = "logit"))
summary(model_glm)

```

```{r}

plot(model_glm)
```




